<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéÆ ‡πÄ‡∏ä‡πá‡∏Ñ‡∏Ñ‡∏ô‡∏ö‡∏¥‡∏î‡πÄ‡∏Å‡∏°</title>

    <meta property="og:title" content="üéÆ ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏ô‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏Å‡∏°">
    <meta property="og:description" content="‡∏Å‡∏î‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡∏î‡∏π‡∏™‡∏¥‡∏ß‡πà‡∏≤‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÉ‡∏Ñ‡∏£‡∏°‡∏≤ ‡πÉ‡∏Ñ‡∏£‡∏ö‡∏¥‡∏î!">
    <meta property="og:image" content="https://yo2548.github.io/my-game-gang1/share-pic.jpg">
    <meta property="og:type" content="website">
    <style>
        body { font-family: sans-serif; background-color: #1a1a2e; color: #fff; text-align: center; padding: 20px; }
        .container { max-width: 500px; margin: 0 auto; background: #16213e; padding: 25px; border-radius: 15px; box-shadow: 0 10px 20px rgba(0,0,0,0.3); }
        
        .btn-report { background: #ffd700; color: #000; padding: 10px 20px; border-radius: 30px; text-decoration: none; font-weight: bold; display: inline-block; margin-bottom: 20px; }
        
        .friend-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(80px, 1fr)); gap: 15px; margin: 20px 0; }
        .friend-card { cursor: pointer; opacity: 0.6; transition: 0.2s; position: relative; }
        
        .friend-card:hover { opacity: 1; transform: translateY(-5px); }
        input[type="radio"]:checked + .friend-card { opacity: 1; transform: scale(1.1); }
        input[type="radio"]:checked + .friend-card img { border: 3px solid #ffd700; box-shadow: 0 0 10px #ffd700; }
        
        /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏Ñ‡∏ô‡∏•‡∏á‡πÅ‡∏•‡πâ‡∏ß */
        .already-done { opacity: 0.3 !important; pointer-events: none; filter: grayscale(100%); }
        .already-done::after { content: '‡∏•‡∏á‡πÅ‡∏•‡πâ‡∏ß'; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: red; color: white; padding: 2px 5px; font-size: 10px; border-radius: 3px; }

        img { width: 70px; height: 70px; border-radius: 50%; object-fit: cover; }
        select, button { width: 100%; padding: 15px; margin-top: 15px; border-radius: 10px; border: none; font-size: 16px; }
        select { background: #0f3460; color: white; }
        button { background: #e94560; color: white; cursor: pointer; font-weight: bold; }
        button:disabled { background: #555; cursor: not-allowed; }
        input[type="radio"] { display: none; }
        
        .loading-text { font-size: 12px; color: #aaa; margin-top: 5px; }
    </style>
</head>
<body>

<div class="container">
    <a href="report.html" class="btn-report">üìÖ ‡∏î‡∏π‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏´‡∏ô‡∏±‡∏á‡∏´‡∏°‡∏≤</a>
    <h2>üöÄ ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÉ‡∏Ñ‡∏£‡∏°‡∏≤‡∏ö‡πâ‡∏≤‡∏á!</h2>
    <div id="checkStatus" class="loading-text">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ä‡πá‡∏Ñ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏ô‡∏•‡∏á‡πÅ‡∏•‡πâ‡∏ß... ‚è≥</div>

    <div class="friend-grid">
        <label><input type="radio" name="friend" value="‡∏û‡∏µ‡πà‡πÄ‡∏ö‡∏µ‡∏¢‡∏£‡πå"><div class="friend-card" id="card-‡∏û‡∏µ‡πà‡πÄ‡∏ö‡∏µ‡∏¢‡∏£‡πå"><img src="beer.jpg"><br>‡∏û‡∏µ‡πà‡πÄ‡∏ö‡∏µ‡∏¢‡∏£‡πå</div></label>
        <label><input type="radio" name="friend" value="‡∏ü‡∏≠‡∏£‡πå‡∏ó"><div class="friend-card" id="card-‡∏ü‡∏≠‡∏£‡πå‡∏ó"><img src="fort.jpg"><br>‡∏ü‡∏≠‡∏£‡πå‡∏ó</div></label>
        <label><input type="radio" name="friend" value="‡πÄ‡∏à"><div class="friend-card" id="card-‡πÄ‡∏à"><img src="jay.jpg"><br>‡πÄ‡∏à</div></label>
        <label><input type="radio" name="friend" value="‡∏ô‡∏≤‡∏¢"><div class="friend-card" id="card-‡∏ô‡∏≤‡∏¢"><img src="nine.jpg"><br>‡∏ô‡∏≤‡∏¢</div></label>
        <label><input type="radio" name="friend" value="‡πÇ‡∏¢"><div class="friend-card" id="card-‡πÇ‡∏¢"><img src="yo.jpg"><br>‡πÇ‡∏¢</div></label>
    </div>

    <select id="gameStatus">
        <option value="‡∏°‡∏≤‡πÄ‡∏•‡πà‡∏ô">‚úÖ ‡∏°‡∏≤‡πÄ‡∏•‡πà‡∏ô</option>
        <option value="‡∏ö‡∏¥‡∏î">üå™Ô∏è ‡∏ö‡∏¥‡∏î</option>
    </select>

    <button onclick="sendData()" id="btnSubmit">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• üéÆ</button>
</div>

<script>
    // ----------------------------------------------------
    // ‚ö†Ô∏è‚ö†Ô∏è ‡∏≠‡∏¢‡πà‡∏≤‡∏•‡∏∑‡∏°‡πÉ‡∏™‡πà URL Google Apps Script ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ !!! ‚ö†Ô∏è‚ö†Ô∏è
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbz07jUjbvxXhjR-pLzOZluFxZHAwEWRA1pQjDy_m51YIlB7uZGkqxJRtw4KSTZNp4B8Hw/exec";
    // ----------------------------------------------------

    let todayRecordedNames = [];

    window.onload = function() {
        fetch(SCRIPT_URL)
        .then(res => res.json())
        .then(data => {
            const d = new Date();
            const todayStr = d.getDate() + "/" + (d.getMonth()+1) + "/" + d.getFullYear();

            data.forEach(item => {
                if(item.date === todayStr) {
                    todayRecordedNames.push(item.name);
                    const card = document.getElementById('card-' + item.name);
                    if(card) card.classList.add('already-done');
                }
            });
            document.getElementById('checkStatus').innerText = "‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠! (‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏•‡∏á‡πÅ‡∏•‡πâ‡∏ß‡∏à‡∏∞‡∏Å‡∏î‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ)";
            document.getElementById('checkStatus').style.color = "#4cd137";
        })
        .catch(err => {
            console.log(err);
            document.getElementById('checkStatus').innerText = "‡πÄ‡∏ä‡πá‡∏Ñ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡πà‡∏≤‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ (‡πÄ‡∏ô‡πá‡∏ï‡∏´‡∏•‡∏∏‡∏î?)";
        });
    }

    function sendData() {
        const btn = document.getElementById('btnSubmit');
        const friend = document.querySelector('input[name="friend"]:checked');
        
        if (!friend) return alert("‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏Å‡πà‡∏≠‡∏ô!");
        const name = friend.value;

        if (todayRecordedNames.includes(name)) {
            alert("‡∏≠‡∏¢‡πà‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ã‡πâ‡∏≥‡πÑ‡∏°‡πà‡∏á‡∏±‡πâ‡∏ô‡πÇ‡∏î‡∏ô");
            return;
        }

        btn.innerText = "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á..."; 
        btn.disabled = true;
        
        fetch(SCRIPT_URL, {
            method: 'POST', 
            mode: 'no-cors',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ name: name, status: document.getElementById('gameStatus').value })
        }).then(() => {
            alert("‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡πâ‡∏ß!"); 
            location.reload();
        }).catch(err => {
            alert("Error: " + err);
            btn.disabled = false;
            btn.innerText = "‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• üéÆ";
        });
    }
</script>

</body>
</html>
