<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéÆ ‡πÄ‡∏ä‡πá‡∏Ñ‡∏Ñ‡∏ô‡∏ö‡∏¥‡∏î‡πÄ‡∏Å‡∏° (VIP)</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background-color: #1a1a2e; color: #fff; text-align: center; padding: 20px; }
        .container { max-width: 500px; margin: 0 auto; background: #16213e; padding: 25px; border-radius: 15px; box-shadow: 0 10px 20px rgba(0,0,0,0.3); }
        .btn-report { background: #ffd700; color: #000; padding: 10px 20px; border-radius: 30px; text-decoration: none; font-weight: bold; display: inline-block; margin-bottom: 20px; }
        .friend-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(80px, 1fr)); gap: 15px; margin: 20px 0; }
        .friend-card { cursor: pointer; opacity: 0.6; transition: 0.2s; position: relative; }
        .friend-card:hover { opacity: 1; transform: translateY(-5px); }
        input[type="radio"]:checked + .friend-card { opacity: 1; transform: scale(1.1); }
        input[type="radio"]:checked + .friend-card img { border: 3px solid #ffd700; box-shadow: 0 0 10px #ffd700; }
        .already-done { opacity: 0.3 !important; pointer-events: none; filter: grayscale(100%); }
        img { width: 70px; height: 70px; border-radius: 50%; object-fit: cover; }
        select, button, input[type="password"] { width: 100%; padding: 15px; margin-top: 15px; border-radius: 10px; border: none; font-size: 16px; box-sizing: border-box; }
        select { background: #0f3460; color: white; }
        input[type="password"] { background: #232342; color: #ffd700; border: 2px solid #333; text-align: center; letter-spacing: 5px; font-weight: bold; }
        button { background: #e94560; color: white; cursor: pointer; font-weight: bold; margin-top: 10px;}
        button:disabled { background: #555; cursor: not-allowed; }
        input[type="radio"] { display: none; }
        .loading-text { font-size: 12px; color: #aaa; margin-top: 5px; }
    </style>
</head>
<body>

<div class="container">
    <a href="report.html" class="btn-report">üìÖ ‡∏î‡∏π‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏´‡∏ô‡∏±‡∏á‡∏´‡∏°‡∏≤</a>
    <h2>üöÄ ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÉ‡∏Ñ‡∏£‡∏°‡∏≤‡∏ö‡πâ‡∏≤‡∏á!</h2>
    <div id="checkStatus" class="loading-text">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ä‡πá‡∏Ñ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠... ‚è≥</div>

    <div class="friend-grid">
        <label><input type="radio" name="friend" value="‡∏û‡∏µ‡πà‡πÄ‡∏ö‡∏µ‡∏¢‡∏£‡πå"><div class="friend-card" id="card-‡∏û‡∏µ‡πà‡πÄ‡∏ö‡∏µ‡∏¢‡∏£‡πå"><img src="beer.jpg"><br>‡∏û‡∏µ‡πà‡πÄ‡∏ö‡∏µ‡∏¢‡∏£‡πå</div></label>
        <label><input type="radio" name="friend" value="‡∏ü‡∏≠‡∏£‡πå‡∏ó"><div class="friend-card" id="card-‡∏ü‡∏≠‡∏£‡πå‡∏ó"><img src="fort.jpg"><br>‡∏ü‡∏≠‡∏£‡πå‡∏ó</div></label>
        <label><input type="radio" name="friend" value="‡πÄ‡∏à"><div class="friend-card" id="card-‡πÄ‡∏à"><img src="jay.jpg"><br>‡πÄ‡∏à</div></label>
        <label><input type="radio" name="friend" value="‡∏ô‡∏≤‡∏¢"><div class="friend-card" id="card-‡∏ô‡∏≤‡∏¢"><img src="nine.jpg"><br>‡∏ô‡∏≤‡∏¢</div></label>
        <label><input type="radio" name="friend" value="‡πÇ‡∏¢"><div class="friend-card" id="card-‡πÇ‡∏¢"><img src="yo.jpg"><br>‡πÇ‡∏¢</div></label>
    </div>

    <select id="gameSelect">
        <option value="Valorant">üî´ Valorant</option>
        <option value="PUBG">üç≥ PUBG</option>
        <option value="Green Hell">üåø Green Hell</option>
        <option value="Other">üé≤ ‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option>
    </select>

    <select id="gameStatus">
        <option value="‡∏°‡∏≤‡πÄ‡∏•‡πà‡∏ô">‚úÖ ‡∏°‡∏≤‡πÄ‡∏•‡πà‡∏ô</option>
        <option value="‡∏ö‡∏¥‡∏î">üå™Ô∏è ‡∏ö‡∏¥‡∏î</option>
    </select>

    <input type="password" id="adminPass" placeholder="üîí ‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏•‡∏±‡∏ö (‡∏ñ‡∏≤‡∏°‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô)" maxlength="10">
    <button onclick="sendData()" id="btnSubmit">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• üéÆ</button>
</div>

<script>
    // ‚ö†Ô∏è‚ö†Ô∏è ‡∏≠‡∏¢‡πà‡∏≤‡∏•‡∏∑‡∏°‡πÅ‡∏Å‡πâ‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì ‚ö†Ô∏è‚ö†Ô∏è
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxk7wWNAFnoC9eJ6ZrN22Xi7zoB-hoqPomVgJvkQaGGR5k9oGlBqq-DNQqxBq209FE14g/exec";
    const SECRET_PIN = "6767"; 

    let todayRecordedNames = [];

    window.onload = function() {
        fetch(SCRIPT_URL)
        .then(res => res.json())
        .then(data => {
            const d = new Date();
            const todayStr = d.getDate() + "/" + (d.getMonth()+1) + "/" + d.getFullYear();
            data.forEach(item => {
                if(item.date === todayStr) {
                    todayRecordedNames.push(item.name);
                    const card = document.getElementById('card-' + item.name);
                    if(card) card.classList.add('already-done');
                }
            });
            document.getElementById('checkStatus').innerText = "‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠!";
            document.getElementById('checkStatus').style.color = "#4cd137";
        })
        .catch(err => { console.log(err); });
    }

    function sendData() {
        const btn = document.getElementById('btnSubmit');
        const friend = document.querySelector('input[name="friend"]:checked');
        const passInput = document.getElementById('adminPass').value;
        
        // ‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡πÄ‡∏Å‡∏°‡∏à‡∏≤‡∏Å Dropdown
        const gameValue = document.getElementById('gameSelect').value; 

        if (!friend) return alert("‚ùå ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏Å‡πà‡∏≠‡∏ô!");
        if (todayRecordedNames.includes(friend.value)) return alert("‚ö†Ô∏è ‡∏Ñ‡∏ô‡∏ô‡∏µ‡πâ‡∏•‡∏á‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß!");
        if (passInput !== SECRET_PIN) return alert("‚õî ‡∏£‡∏´‡∏±‡∏™‡∏ú‡∏¥‡∏î!");

        btn.innerText = "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á..."; btn.disabled = true;
        
        // ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (‡∏ä‡∏∑‡πà‡∏≠‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö Google Script ‡πÄ‡∏õ‡πä‡∏∞‡πÜ)
        const payload = {
            name: friend.value,
            status: document.getElementById('gameStatus').value,
            game: gameValue  // ‡∏™‡πà‡∏á key ‡∏ä‡∏∑‡πà‡∏≠ "game" ‡πÑ‡∏õ
        };

        fetch(SCRIPT_URL, {
            method: 'POST', 
            mode: 'no-cors',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(payload)
        }).then(() => {
            alert("‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡πâ‡∏ß! ‡πÄ‡∏•‡πà‡∏ô: " + gameValue); 
            location.reload();
        }).catch(err => {
            alert("Error: " + err);
            btn.disabled = false;
        });
    }
</script>
</body>
</html>
